<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>FORO | NEMO_704 {{ title }}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body class="dark-theme">
    <header class="main-header">
        <nav class="navbar">
            <a href="/">INICIO</a>
            <a href="/videos">VIDEOS</a>
            <a href="/foro" class="active">FORO</a>
        </nav>
    </header>

    <main class="container">
        {% if session.get('user') %}
        <div class="forum-header">
            <p>Bienvenido, <strong>{{ session['user'] }}</strong></p>
            <a href="/logout" class="logout-btn">Cerrar Sesión</a>
        </div>

        <form action="/post" method="POST" class="post-form" enctype="multipart/form-data">
            <textarea name="content" placeholder="Escribe un nuevo post..." required></textarea>
            
            <div class="multimedia-grid">
                <div class="file-box">
                    <label for="img"><i class="fas fa-camera"></i> Subir Foto</label>
                    <input type="file" name="image_file" id="img" accept="image/*">
                </div>
                <div class="file-box">
                    <label for="vid"><i class="fas fa-video"></i> Subir Video</label>
                    <input type="file" name="video_file" id="vid" accept="video/*">
                </div>
            </div>
            
            <button type="submit" class="btn-nemo">PUBLICAR</button>
        </form>

        <h2 class="section-title">{{ title }}</h2>

        <div class="posts-feed">
            {% for post in posts %}
            <div class="post-card">
                <div class="post-info">
                    <span class="author">@{{ post.author }}</span>
                    <span class="date">{{ post.timestamp[:10] }}</span>
                </div>
                <p class="post-text">{{ post.content }}</p>

                {% if post.image_url %}
                <div class="media-container">
                    <img src="{{ post.image_url }}" class="post-img" onclick="window.open(this.src)">
                </div>
                {% endif %}

                {% if post.video_url %}
                <div class="media-container">
                    <video controls class="post-video">
                        <source src="{{ post.video_url }}" type="video/mp4">
                        Tu navegador no soporta videos.
                    </video>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        
        {% else %}
        <div class="auth-container">
            <h3>ÚNETE A LA COMUNIDAD</h3>
            <form action="/login" method="POST">
                <input type="text" name="username" placeholder="Usuario" required>
                <input type="password" name="password" placeholder="Contraseña" required>
                <button type="submit" class="btn-nemo">ENTRAR</button>
            </form>
        </div>
        {% endif %}
    </main>
</body>
</html>
