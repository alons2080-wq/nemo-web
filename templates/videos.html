<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Videos | NEMO_704</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/favicon.png') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header class="main-header">
        <div class="navbar">
            <div class="logo-circle">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Nemo">
            </div>
            <nav>
                <ul class="nav-menu">
                    <li><a href="/">INICIO</a></li>
                    <li><a href="/videos">VIDEOS</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <h2 class="section-title">Todos los Videos de Nemo ðŸŽ¬</h2>
        <div id="video-feed" class="video-grid">
            <p style="color: var(--accent); grid-column: 1/-1; text-align: center;">Cargando contenido desde YouTube...</p>
        </div>
    </main>

    <script>
        // Usamos un proxy para evitar problemas de CORS y traer el XML de YouTube convertido a JSON
        const channelID = "UCpP_S_m7_N7O0yX_D9B4w9Q"; 
        const feedUrl = `https://www.youtube.com/feeds/videos.xml?channel_id=${channelID}`;
        const finalUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(feedUrl)}`;

        fetch(finalUrl)
            .then(res => res.json())
            .then(data => {
                const container = document.getElementById('video-feed');
                if (data.status === 'ok') {
                    container.innerHTML = ''; // Limpiamos el texto de "Cargando"
                    data.items.forEach(item => {
                        // Extraemos el ID del video de la URL
                        const videoID = item.link.split('v=')[1];
                        container.innerHTML += `
                            <a href="${item.link}" target="_blank" class="video-card">
                                <div class="v-img" style="background-image: url('https://img.youtube.com/vi/${videoID}/maxresdefault.jpg')"></div>
                                <div class="v-info">
                                    <h3>${item.title}</h3>
                                </div>
                            </a>
                        `;
                    });
                } else {
                    container.innerHTML = '<p>No se pudieron cargar los videos. Revisa el ID del canal.</p>';
                }
            })
            .catch(err => {
                console.error("Error:", err);
                document.getElementById('video-feed').innerHTML = '<p>Error de conexiÃ³n.</p>';
            });
    </script>
</body>
</html>
